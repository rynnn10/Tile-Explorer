<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"
    />
    <meta name="theme-color" content="#3b82f6" />
    <title>Tile Explorer - Riyan Edition Ultimate</title>
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" href="assets/iconapk.jpg" type="image/png" />
    <link rel="shortcut icon" href="assets/iconapk.jpg" type="image/png" />

    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body
    id="game-body"
    class="theme-ocean h-screen w-screen fixed text-slate-800 overflow-hidden"
  >
    >
    <audio id="bgm-audio" loop preload="auto">
      <source src="sfx/bc.mp3" type="audio/mpeg" />
    </audio>
    <div
      id="start-screen"
      class="absolute inset-0 z-[200] flex flex-col items-center justify-center p-4 transition-transform duration-500 overflow-y-auto"
    >
      <div class="mb-6 relative animate-float mt-10 md:mt-0">
        <div
          class="absolute -top-10 -left-10 text-yellow-300 opacity-50 transform -rotate-12"
        >
          <svg width="60" height="60" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-5.82 3.25L7.38 14.14 2 9.27l6.91-1.01L12 2z"
            />
          </svg>
        </div>
        <div
          class="bg-white/10 backdrop-blur-md border-2 border-white/30 p-8 rounded-[2rem] shadow-2xl text-center relative overflow-hidden"
        >
          <h1
            class="text-5xl md:text-6xl font-black text-white drop-shadow-[0_4px_4px_rgba(0,0,0,0.3)] tracking-tight leading-tight"
          >
            TILE<br />
            <span class="text-yellow-300">EXPLORER</span>
          </h1>
          <div
            class="mt-2 text-white/80 font-bold tracking-widest text-sm uppercase"
          >
            Puzzle Adventure
          </div>
        </div>
      </div>

      <div
        class="mb-6 bg-white/20 backdrop-blur-sm rounded-xl p-4 w-full max-w-xs flex justify-between items-center border border-white/30 shadow-lg"
      >
        <div class="text-white text-left">
          <p class="text-xs font-bold uppercase opacity-80">Skor Tertinggi</p>
          <p id="high-score-display" class="text-2xl font-black">0</p>
        </div>
        <div class="text-right">
          <div
            class="bg-yellow-400 text-yellow-900 px-3 py-1 rounded-full text-xs font-bold shadow-sm flex items-center gap-1"
          >
            Best
          </div>
        </div>
      </div>

      <div class="w-full max-w-xs space-y-3 pb-8">
        <button
          id="btn-continue"
          onclick="continueGame()"
          class="hidden w-full group relative px-6 py-3 bg-green-500 rounded-2xl shadow-lg hover:bg-green-600 hover:-translate-y-1 transition-all duration-300"
        >
          <div class="flex items-center justify-center gap-3 text-white">
            <span class="text-xl font-bold">LANJUTKAN</span>
          </div>
        </button>

        <button
          onclick="confirmNewGame()"
          class="w-full group relative px-6 py-3 bg-white rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300"
        >
          <div class="flex items-center justify-center gap-3">
            <div
              class="bg-blue-500 text-white p-1.5 rounded-full group-hover:rotate-12 transition-transform"
            >
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path d="M8 5v14l11-7z" />
              </svg>
            </div>
            <span
              class="text-xl font-bold text-slate-700 group-hover:text-blue-600 transition-colors"
              >MAIN SEKARANG</span
            >
          </div>
        </button>

        <button
          onclick="showLevelSelect()"
          class="w-full px-6 py-3 bg-indigo-500 rounded-2xl shadow-lg hover:bg-indigo-600 transition-all text-white font-bold flex items-center justify-center gap-2"
        >
          <svg
            width="24"
            height="24"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"
            />
          </svg>
          Pilih Level
        </button>

        <button
          onclick="showInfoModal()"
          class="w-full px-6 py-3 bg-white/20 border border-white/40 rounded-2xl hover:bg-white/30 transition text-white font-bold flex items-center justify-center gap-2"
        >
          Info & Tema
        </button>

        <button
          onclick="exitApp()"
          class="w-full px-6 py-3 bg-red-500/80 border border-red-400 rounded-2xl hover:bg-red-600 transition text-white font-bold flex items-center justify-center gap-2"
        >
          Keluar Aplikasi
        </button>
      </div>

      <p class="mt-auto mb-4 text-white/60 text-sm font-medium text-center">
        Versi 1.0 - Riyan 2025 <br />
        <span class="text-xs opacity-70"
          >IP: <span id="ip-display">Mendeteksi...</span></span
        >
      </p>
    </div>

    <div
      id="game-header"
      class="absolute top-0 w-full z-40 pointer-events-none h-16 transition-all duration-300"
    >
      <div
        class="flex justify-between items-start p-3 bg-white/40 backdrop-blur-sm shadow-sm border-b border-white/50"
      >
        <div
          class="pointer-events-auto bg-white shadow-sm rounded-xl px-3 py-1.5 flex items-center gap-2 border border-slate-100"
        >
          <div class="bg-orange-500 text-white p-1.5 rounded-lg">üèÜ</div>
          <div>
            <p class="text-[9px] text-slate-400 font-bold uppercase">Skor</p>
            <p
              id="score-display"
              class="font-bold text-lg text-slate-700 leading-none"
            >
              0
            </p>
          </div>
        </div>

        <div class="pointer-events-auto flex items-center gap-2">
          <div
            id="level-display"
            class="bg-blue-600 text-white px-4 py-1.5 rounded-full font-bold shadow-md text-sm border-2 border-blue-400"
          >
            Level 1
          </div>

          <button
            onclick="useHint()"
            id="btn-hint"
            class="relative p-2 bg-purple-100 rounded-full hover:bg-purple-200 transition shadow-sm text-purple-600 border border-purple-300"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="m19 2 2 2-2 2-2-2 2-2Z" />
              <path d="m5 2 2 2-2 2-2-2 2-2Z" />
              <path
                d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"
              />
              <path
                d="m12 15-3-3a22 22 0 0 1 2-2 9.5 9.5 0 0 1 2.13-2.13c.79-.79 2.07-.79 2.91 0a2.18 2.18 0 0 1 .09 2.91c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"
              />
              <path d="m12 15 3 3" />
            </svg>

            <span
              id="hint-count"
              class="absolute -top-1 -right-1 bg-red-500 text-white text-[9px] font-bold w-4 h-4 rounded-full flex items-center justify-center border border-white"
              >3</span
            >
          </button>

          <button
            onclick="showSettingsModal()"
            class="p-2 bg-slate-200 rounded-full hover:bg-slate-300 transition shadow-sm text-slate-600"
          >
            ‚öôÔ∏è
          </button>
        </div>
      </div>
    </div>

    <div
      id="tray-container-wrapper"
      class="absolute top-20 left-0 w-full flex justify-center z-30 pointer-events-none transition-all duration-300 px-4 md:px-0"
    >
      <div
        id="tray-scaler"
        class="pointer-events-auto transition-transform duration-300 ease-out origin-top max-w-full md:max-w-[95vw]"
        style="box-sizing: border-box"
      >
        <div
          class="bg-slate-800/90 backdrop-blur-xl py-3 px-6 rounded-2xl shadow-xl border-2 border-white/20 relative mx-auto box-border min-w-fit"
        >
          <div
            id="tray-content"
            class="flex justify-center items-center gap-2"
          ></div>
          <div class="absolute -bottom-3 left-1/2 transform -translate-x-1/2">
            <div
              class="bg-red-500 text-white text-[10px] font-bold px-3 py-0.5 rounded-full shadow-md border border-red-400"
            >
              <span id="tray-count">0</span>/7
            </div>
          </div>
        </div>
      </div>
    </div>

    <div
      class="absolute inset-0 flex items-center justify-center pointer-events-none"
    >
      <div
        id="board-container"
        class="relative transition-transform duration-300 ease-out will-change-transform pointer-events-auto"
        style="width: 0; height: 0"
      ></div>
    </div>

    <div
      id="game-footer"
      class="absolute bottom-0 w-full bg-white/50 backdrop-blur-md border-t border-white/40 p-2 text-center z-50 h-[40px] flex items-center justify-center transition-all duration-300"
    >
      <p class="text-slate-600 text-xs font-semibold tracking-wide">
        ¬© Copyright <span class="text-blue-600">Riyan</span> 2025
      </p>
    </div>

    <div
      id="settings-modal"
      class="absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[210] hidden opacity-0 transition-opacity duration-300"
    >
      <div
        class="bg-white p-6 rounded-3xl shadow-2xl modal-box transform scale-100 transition-transform"
      >
        <h2
          class="text-2xl font-black text-slate-800 mb-4 text-center border-b pb-2"
        >
          PENGATURAN
        </h2>

        <div class="space-y-4">
          <div class="bg-slate-50 p-4 rounded-2xl border border-slate-200">
            <h3
              class="text-sm font-bold text-slate-500 mb-3 uppercase tracking-wider"
            >
              Pengaturan Suara
            </h3>

            <div class="mb-4">
              <div class="flex justify-between mb-1">
                <span class="text-xs font-bold text-slate-600"
                  >Musik (BGM)</span
                >
                <span id="bgm-val" class="text-xs font-bold text-blue-500"
                  >50%</span
                >
              </div>
              <input
                type="range"
                min="0"
                max="100"
                value="50"
                oninput="updateVolume('bgm', this.value)"
                class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-500"
              />
            </div>

            <div>
              <div class="flex justify-between mb-1">
                <span class="text-xs font-bold text-slate-600"
                  >Efek Suara (SFX)</span
                >
                <span id="sfx-val" class="text-xs font-bold text-purple-500"
                  >80%</span
                >
              </div>
              <input
                type="range"
                min="0"
                max="100"
                value="80"
                oninput="updateVolume('sfx', this.value)"
                class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-purple-500"
              />
            </div>
          </div>

          <button
            onclick="goToMainMenu()"
            class="w-full bg-red-100 hover:bg-red-200 text-red-600 font-bold py-3 rounded-xl flex items-center justify-center gap-2"
          >
            Ke Menu Utama
          </button>

          <button
            onclick="closeSettingsModal()"
            class="w-full mt-2 bg-slate-800 hover:bg-slate-900 text-white font-bold py-3 rounded-xl"
          >
            Tutup
          </button>
        </div>
      </div>
    </div>

    <div
      id="level-select-modal"
      class="absolute inset-0 bg-black/80 backdrop-blur-md flex items-center justify-center z-[215] hidden opacity-0 transition-opacity duration-300"
    >
      <div
        class="bg-white w-full max-w-md h-[80vh] m-4 rounded-3xl shadow-2xl flex flex-col overflow-hidden"
      >
        <div
          class="p-4 bg-slate-100 border-b flex justify-between items-center"
        >
          <h2 class="text-2xl font-black text-slate-800">PILIH LEVEL</h2>
          <button
            onclick="closeLevelSelect()"
            class="bg-slate-200 p-2 rounded-full hover:bg-slate-300 font-bold"
          >
            ‚ùå
          </button>
        </div>
        <div
          id="level-grid"
          class="flex-1 overflow-y-auto p-6 grid grid-cols-4 gap-4 content-start"
        ></div>
      </div>
    </div>

    <div
      id="info-modal"
      class="absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[220] hidden opacity-0 transition-opacity duration-300"
    >
      <div
        class="bg-white p-5 rounded-3xl shadow-2xl modal-box h-[85vh] flex flex-col overflow-hidden"
      >
        <div class="flex justify-between items-center mb-2 border-b pb-2">
          <h2 class="text-xl font-black text-slate-800 tracking-tight">
            PANDUAN & TEMA
          </h2>
          <button
            onclick="closeInfoModal()"
            class="bg-slate-100 p-2 rounded-full hover:bg-slate-200 text-slate-600 font-bold"
          >
            ‚úï
          </button>
        </div>

        <div class="flex-1 overflow-y-auto scrollbar-hide space-y-5 pr-1 pb-4">
          <div
            class="bg-gradient-to-br from-slate-50 to-blue-50 p-4 rounded-2xl border border-blue-100 shadow-sm"
          >
            <h3
              class="font-bold text-slate-700 text-center mb-3 text-sm uppercase tracking-wider"
            >
              Pilih Tema (10 Pilihan)
            </h3>
            <div class="grid grid-cols-5 gap-2">
              <button
                onclick="changeTheme('theme-ocean')"
                class="flex flex-col items-center gap-1 group"
              >
                <div
                  class="w-8 h-8 rounded-full bg-sky-400 border-2 border-white shadow-sm group-hover:scale-110 transition"
                ></div>
                <span class="text-[8px] font-bold text-slate-600">Ocean</span>
              </button>
              <button
                onclick="changeTheme('theme-sakura')"
                class="flex flex-col items-center gap-1 group"
              >
                <div
                  class="w-8 h-8 rounded-full bg-pink-300 border-2 border-white shadow-sm group-hover:scale-110 transition"
                ></div>
                <span class="text-[8px] font-bold text-slate-600">Sakura</span>
              </button>
              <button
                onclick="changeTheme('theme-forest')"
                class="flex flex-col items-center gap-1 group"
              >
                <div
                  class="w-8 h-8 rounded-full bg-green-400 border-2 border-white shadow-sm group-hover:scale-110 transition"
                ></div>
                <span class="text-[8px] font-bold text-slate-600">Forest</span>
              </button>
              <button
                onclick="changeTheme('theme-candy')"
                class="flex flex-col items-center gap-1 group"
              >
                <div
                  class="w-8 h-8 rounded-full bg-yellow-200 border-2 border-white shadow-sm group-hover:scale-110 transition"
                ></div>
                <span class="text-[8px] font-bold text-slate-600">Candy</span>
              </button>
              <button
                onclick="changeTheme('theme-sunset')"
                class="flex flex-col items-center gap-1 group"
              >
                <div
                  class="w-8 h-8 rounded-full bg-orange-400 border-2 border-white shadow-sm group-hover:scale-110 transition"
                ></div>
                <span class="text-[8px] font-bold text-slate-600">Sunset</span>
              </button>

              <button
                onclick="changeTheme('theme-cyberpunk')"
                class="flex flex-col items-center gap-1 group"
              >
                <div
                  class="w-8 h-8 rounded-full bg-slate-900 border-2 border-cyan-400 shadow-sm group-hover:scale-110 transition"
                ></div>
                <span class="text-[8px] font-bold text-slate-600">Cyber</span>
              </button>
              <button
                onclick="changeTheme('theme-galaxy')"
                class="flex flex-col items-center gap-1 group"
              >
                <div
                  class="w-8 h-8 rounded-full bg-indigo-900 border-2 border-purple-400 shadow-sm group-hover:scale-110 transition"
                ></div>
                <span class="text-[8px] font-bold text-slate-600">Galaxy</span>
              </button>
              <button
                onclick="changeTheme('theme-royal')"
                class="flex flex-col items-center gap-1 group"
              >
                <div
                  class="w-8 h-8 rounded-full bg-stone-800 border-2 border-yellow-500 shadow-sm group-hover:scale-110 transition"
                ></div>
                <span class="text-[8px] font-bold text-slate-600">Royal</span>
              </button>
              <button
                onclick="changeTheme('theme-retro')"
                class="flex flex-col items-center gap-1 group"
              >
                <div
                  class="w-8 h-8 rounded-full bg-fuchsia-900 border-2 border-pink-500 shadow-sm group-hover:scale-110 transition"
                ></div>
                <span class="text-[8px] font-bold text-slate-600">Retro</span>
              </button>
              <button
                onclick="changeTheme('theme-matrix')"
                class="flex flex-col items-center gap-1 group"
              >
                <div
                  class="w-8 h-8 rounded-full bg-black border-2 border-green-500 shadow-sm group-hover:scale-110 transition"
                ></div>
                <span class="text-[8px] font-bold text-slate-600">Hacker</span>
              </button>
            </div>
          </div>

          <div>
            <h3 class="font-bold text-slate-800 mb-2 flex items-center gap-2">
              <span class="bg-green-100 text-green-600 p-1 rounded-md text-xs"
                >?</span
              >
              Cara Bermain
            </h3>
            <ul
              class="text-sm text-slate-600 space-y-2 list-none bg-slate-50 p-3 rounded-xl"
            >
              <li class="flex gap-2">
                <span>üëâ</span>
                <span
                  >Pilih <strong>3 ubin sama</strong> untuk menghapusnya.</span
                >
              </li>
              <li class="flex gap-2">
                <span>üëâ</span>
                <span
                  >Baki (Tray) hanya muat <strong>7 ubin</strong>. Jangan sampai
                  penuh!</span
                >
              </li>
              <li class="flex gap-2">
                <span>üëâ</span>
                <span>Habiskan semua ubin di papan untuk menang.</span>
              </li>
            </ul>
          </div>

          <div>
            <h3 class="font-bold text-slate-800 mb-2 flex items-center gap-2">
              <span class="bg-purple-100 text-purple-600 p-1 rounded-md text-xs"
                >‚òÖ</span
              >
              Item Petualangan
            </h3>
            <div class="grid grid-cols-4 gap-2 text-center">
              <div
                class="bg-slate-50 p-2 rounded-lg border text-[10px] font-bold text-slate-500"
              >
                üó∫Ô∏è<br />Peta Kuno
              </div>
              <div
                class="bg-slate-50 p-2 rounded-lg border text-[10px] font-bold text-slate-500"
              >
                ‚öîÔ∏è<br />Pedang
              </div>
              <div
                class="bg-slate-50 p-2 rounded-lg border text-[10px] font-bold text-slate-500"
              >
                üíé<br />Permata
              </div>
              <div
                class="bg-slate-50 p-2 rounded-lg border text-[10px] font-bold text-slate-500"
              >
                üß≠<br />Kompas
              </div>
              <div
                class="bg-slate-50 p-2 rounded-lg border text-[10px] font-bold text-slate-500"
              >
                üíÄ<br />Bahaya
              </div>
              <div
                class="bg-slate-50 p-2 rounded-lg border text-[10px] font-bold text-slate-500"
              >
                üëë<br />Harta
              </div>
              <div
                class="bg-slate-50 p-2 rounded-lg border text-[10px] font-bold text-slate-500"
              >
                üß™<br />Ramuan
              </div>
              <div
                class="bg-slate-50 p-2 rounded-lg border text-[10px] font-bold text-slate-500"
              >
                üîë<br />Kunci
              </div>
            </div>
          </div>

          <div class="text-center mt-4">
            <p class="text-xs text-slate-400">Versi 1.0 ‚Ä¢ Riyan 2025</p>
          </div>
        </div>
      </div>
    </div>

    <div
      id="overlay"
      class="absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[150] opacity-0 pointer-events-none transition-opacity duration-300"
    >
      <div
        id="overlay-content"
        class="bg-white p-6 rounded-3xl shadow-2xl text-center modal-box transform transition-all duration-300 scale-90"
      ></div>
    </div>

    <div
      id="exit-modal"
      class="absolute inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[250] hidden opacity-0 transition-opacity duration-300"
    >
      <div
        class="bg-white p-6 rounded-3xl shadow-2xl modal-box max-w-sm text-center transform scale-100 transition-transform"
      >
        <div
          class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl"
        >
          üö™
        </div>
        <h2 class="text-xl font-black text-slate-800 mb-2">Keluar Game?</h2>
        <p class="text-slate-600 text-sm mb-6">
          Apakah Anda yakin ingin menutup aplikasi Tile Explorer?
        </p>
        <div class="grid grid-cols-2 gap-3">
          <button
            onclick="closeExitModal()"
            class="py-3 rounded-xl font-bold text-slate-600 bg-slate-100 hover:bg-slate-200 transition"
          >
            Batal
          </button>
          <button
            onclick="confirmExitApp()"
            class="py-3 rounded-xl font-bold text-white bg-red-500 hover:bg-red-600 shadow-lg transition"
          >
            Ya, Keluar
          </button>
        </div>
      </div>
    </div>

    <div
      id="level-confirm-modal"
      class="absolute inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[250] hidden opacity-0 transition-opacity duration-300"
    >
      <div
        class="bg-white p-6 rounded-3xl shadow-2xl modal-box max-w-sm text-center transform scale-100 transition-transform"
      >
        <div
          class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl"
        >
          ‚ö†Ô∏è
        </div>
        <h2 class="text-xl font-black text-slate-800 mb-2">Pindah Level?</h2>
        <p class="text-slate-600 text-sm mb-6">
          Jika pindah level sekarang,
          <span class="font-bold text-red-500"
            >Skor Saat Ini akan direset ke 0</span
          >. Skor Tertinggi tetap aman.
        </p>
        <div class="grid grid-cols-2 gap-3">
          <button
            onclick="closeLevelConfirmModal()"
            class="py-3 rounded-xl font-bold text-slate-600 bg-slate-100 hover:bg-slate-200 transition"
          >
            Batal
          </button>
          <button
            id="btn-confirm-jump"
            class="py-3 rounded-xl font-bold text-white bg-blue-600 hover:bg-blue-700 shadow-lg transition"
          >
            Lanjut Pindah
          </button>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
    <script>
      // Register Service Worker untuk PWA
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("./sw.js")
            .then((reg) => console.log("Service Worker registered", reg))
            .catch((err) => console.log("Service Worker failed", err));
        });
      }
    </script>
  </body>
</html>
